/* --- Animations --- */
@keyframes menuItemsIn {
  from {
    opacity: 0;
    transform: translateY(-8px);
  }

  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes pulseGlow {
  0% {
    transform: translate(-50%, -50%) scale(1);
    opacity: 0.6;
    box-shadow: 0 0 0 0 rgba(135, 200, 38, 0.4);
  }

  70% {
    transform: translate(-50%, -50%) scale(5.5);
    opacity: 0;
    box-shadow: 0 0 0 10px rgba(135, 200, 38, 0);
  }

  100% {
    transform: translate(-50%, -50%) scale(1);
    opacity: 0;
    box-shadow: 0 0 0 0 rgba(135, 200, 38, 0);
  }
}

@keyframes pulseDot {
  0% {
    box-shadow: 0 0 0 0 rgba(135, 200, 38, 0.45);
  }

  70% {
    box-shadow: 0 0 0 10px rgba(135, 200, 38, 0);
  }

  100% {
    box-shadow: 0 0 0 0 rgba(135, 200, 38, 0);
  }
}

/* --- Container --- */
.nav {
  position: fixed;
  top: 18px;
  left: 0;
  right: 0;
  z-index: 50;
  padding: 0 16px;
  /* Mobile default: center alignment for floating bar */
  display: flex;
  justify-content: center;
}

.navOpen {
  height: auto;
  /* Allow full height when open on mobile */
  z-index: 80;
}

/* --- Bar (Mobile Base) --- */
.bar {
  --header-bar-collapsed: 96px;
  --header-bar-expanded: 460px;

  width: 100%;
  max-width: 360px;
  padding: 10px 16px;

  /* Mobile Grid Layout */
  display: grid;
  grid-template-columns: auto 1fr auto auto;
  /* Avatar, Spacer, Actions, MenuBtn */
  align-items: center;
  column-gap: 12px;

  border-radius: 36px;
  border: 1px solid #b7b7b7;
  background: #d9d9d9;
  position: relative;
  overflow: hidden;
  max-height: var(--header-bar-collapsed);

  transition: width 0.35s ease, max-width 0.35s ease, padding 0.35s ease,
    border-radius 0.35s ease, gap 0.35s ease, box-shadow 0.35s ease,
    background 0.35s ease, border-color 0.35s ease, transform 0.35s ease,
    max-height 0.45s cubic-bezier(0.22, 1, 0.36, 1);
  will-change: max-height;
}

/* Mobile Expanded State */
.barOpen {
  width: calc(100% - 12px);
  max-width: 320px;
  padding: 36px 24px 28px;

  grid-template-columns: auto 1fr auto;
  grid-template-rows: auto auto auto;
  gap: 24px 16px;
  align-items: start;

  box-shadow: none;
  margin: 0 auto;
  max-height: var(--header-bar-expanded);
}

/* --- Avatar --- */
.avatar {
  grid-column: 1;
  grid-row: 1;
  width: 40px;
  height: 40px;
  border-radius: 50%;
  overflow: hidden;
  flex: 0 0 auto;
  background: #692c2c;
  display: grid;
  place-items: center;
}

.avatar img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.barOpen .avatar {
  width: 52px;
  height: 52px;
  box-shadow: 0 12px 26px rgba(31, 103, 241, 0.15);
}

/* --- Links (Mobile Base: Hidden Grid Item) --- */
.links {
  grid-column: 3;
  grid-row: 1;
  display: grid;
  grid-template-columns: auto;
  align-items: center;
  justify-content: start;
  gap: 12px;
  margin-inline-start: 0;
  justify-items: start;
  font-family: var(--font-poppins), "Poppins", sans-serif;
}

.links .link:not(.localeLink) {
  display: none;
  /* Hide nav links on mobile closed bar */
}

/* Links Component Styles */
.link {
  position: relative;
  font-size: 16px;
  line-height: 1.35;
  color: #1f67f1;
  text-decoration: none;
  transition: opacity 0.25s ease;
}

.link:hover {
  opacity: 0.8;
}

/* .linkHome::after removed to rely on .linkActive logic */

.linkActive::after {
  content: "";
  position: absolute;
  bottom: -12px;
  left: 50%;
  translate: -50% 0;
  width: 11px;
  height: 11px;
  border-radius: 50%;
  background: #ea5039;
}

.localeLink::after {
  width: 28px;
  bottom: -6px;
}

/* Mobile size */

.localeText {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  font-weight: 600;
}

/* --- Links Open (Mobile Dropdown Content) --- */
.linksOpen {
  grid-column: 1 / -1;
  grid-row: 2;
  width: 100%;
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  gap: 18px;
  opacity: 0;
  transform: translateY(-8px);
  animation: menuItemsIn 0.35s ease forwards;
}

.linksOpen .link {
  font-size: 18px;
  display: inline-flex;
}

.linksOpen .linkHome {
  display: inline-flex;
  align-items: center;
  gap: 12px;
}

.linksOpen .linkHome::before {
  content: "";
  display: inline-block;
  width: 10px;
  height: 10px;
  border-radius: 50%;
  background: #ea5039;
}

/* Hide duplicate indicators in open menu */
.linksOpen .linkHome::after {
  display: none;
}

.linksOpen .linkActive::after {
  display: none;
}

.linksOpen .localeLink {
  display: none;
}

/* --- Menu Button (Mobile Visible) --- */
.menuButton {
  display: grid;
  place-items: center;
  width: 44px;
  height: 44px;
  border-radius: 50%;
  border: none;
  background: #1f67f1;
  color: white;
  padding: 0;
  cursor: pointer;
  grid-column: 4;
  grid-row: 1;
  justify-self: end;
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.menuButton:hover {
  transform: translateY(-2px);
}

.menuButton:focus-visible {
  outline: 2px solid #0d3fba;
  outline-offset: 3px;
}

.barOpen .menuButton {
  grid-column: 3;
}

.barOpen .menuButton:hover {
  transform: none;
}

/* --- Actions (Contact) --- */
.actions {
  grid-column: 2;
  grid-row: 1;
  display: flex;
  align-items: center;
  justify-content: flex-start;
  gap: 20px;
}

.contactBtn {
  /* Mobile Base: Text link style */
  padding: 0;
  background: transparent;
  color: #1a1a1a;
  box-shadow: none;
  font-size: 14px;
  line-height: 1.35;
  text-decoration: none;
  font-weight: 600;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  transition: color 0.2s ease;
}

.contactBtn:hover {
  transform: none;
  color: #0f0f0f;
}

.contactLabelDesktop {
  display: none;
}

.contactLabelMobile {
  display: inline-flex;
  align-items: center;
  font-size: 14px;
  color: #525252;
  letter-spacing: 0;
  font-family: var(--font-poppins);
  font-weight: 100;
}

.pulseWrapper {
  display: inline-flex;
  align-items: center;
  margin-inline-start: 8px;
}

.pulse {
  width: 6px;
  height: 6px;
  border-radius: 50%;
  background: #87c826;
  position: relative;
  box-shadow: 0 0 0 0 rgba(135, 200, 38, 0.45);
  animation: pulseDot 1.6s ease-out infinite;
}

.pulse::after {
  content: "";
  position: absolute;
  top: 50%;
  left: 50%;
  width: 6px;
  height: 6px;
  border-radius: 50%;
  background: rgba(135, 200, 38, 0.5);
  transform: translate(-50%, -50%) scale(1);
  box-shadow: 0 0 0 0 rgba(135, 200, 38, 0.4);
  animation: pulseGlow 1.6s ease-out infinite;
  transform-origin: center;
  z-index: 0;
}

/* Actions Menu (Inside expanded mobile bar) */
.actionsMenu {
  grid-column: 1 / -1;
  grid-row: 3;
  width: 100%;
  justify-content: center;
  margin-top: 0;
}

.actionsMenu .contactBtn {
  width: 100%;
  padding: 16px 0;
  border-radius: 32px;
  background: linear-gradient(135deg, #1f67f1 0%, #3e7bff 100%);
  color: #ffffff;
  font-size: 16px;
  transition: background 0.2s ease, box-shadow 0.2s ease, transform 0.2s ease;
}

.actionsMenu .contactBtn:hover {
  color: #ffffff;
  transform: translateY(-1px);
}

.actionsMenu .contactLabelDesktop {
  display: inline;
  font-size: 18px;
  font-weight: 600;
}

.actionsMenu .contactLabelMobile {
  display: none;
}

/* --- Mobile Small Screen Adjustments (< 500px) --- */
@media (max-width: 500px) {
  .bar {
    max-width: 90%;
    column-gap: 10px;
  }

  .barOpen {
    max-width: calc(100% - 32px);
    padding: 15px 20px 24px;
    row-gap: 32px;
  }

  .menuButton {
    width: 40px;
    height: 40px;
  }

  .menuButton span {
    width: 16px;
  }

  /* Icon size adjustment if needed */
  .linksOpen {
    justify-content: center;
    align-items: center;
  }

  .linksOpen .link {
    font-size: 17px;
  }

  .actionsMenu .contactBtn {
    padding: 12px 0;
  }
}

/* --------------------------------------------------------- */
/* --- DESKTOP BREAKPOINT (min-width: 721px) --- */
/* --------------------------------------------------------- */
@media (min-width: 721px) {
  .nav {
    display: block;
    /* Reset centering */
  }

  /* Bar Desktop */
  .bar {
    display: flex;
    align-items: center;
    width: fit-content;
    max-width: none;
    min-height: 60px;
    margin: 16px auto;

    /* Starting Desktop Gaps (Small Desktop / Tablet) */
    gap: 28px;
    padding: 10px 18px;

    grid-template-columns: none;
    max-height: none;
    cursor: default;
  }

  .avatar {
    grid-column: auto;
    width: 40px;
    height: 40px;
  }

  /* Links Desktop */
  .links {
    display: flex;
    align-items: flex-end;
    gap: 32px;
    /* Small desktop gap */
    grid-column: auto;
    grid-row: auto;
    margin-inline-start: 0;
  }

  .links .link:not(.localeLink) {
    display: inline;
  }

  .localeLink::after {
    width: 45px;
  }

  /* Desktop size */

  /* Hide Mobile Elements */
  .menuButton {
    display: none;
  }

  .contactLabelMobile {
    display: none;
  }

  .pulseWrapper {
    display: none;
  }

  .linksOpen {
    display: none !important;
  }

  /* Actions Desktop */
  .actions {
    grid-column: auto;
    justify-content: center;
  }

  .contactLabelDesktop {
    display: inline;
  }

  .contactBtn {
    /* Restore Desktop Pill Styles */
    display: inline-flex;
    padding: 10px 22px;
    border-radius: 62px;
    background: #1f67f1;
    color: #d9d9d9;
    font-size: 16px;
    line-height: 1.35;
    box-shadow: none;
  }

  .contactBtn:hover {
    transform: translateY(-3px);
    box-shadow: 0 14px 26px rgba(31, 103, 241, 0.32);
    color: #d9d9d9;
  }
}

/* --- Medium Desktop (min-width: 981px) --- */
@media (min-width: 981px) {
  .bar {
    gap: 32px;
  }

  /* Links gap stays 32px until larger screen if consistent with previous design? Previous said links gap 32px at max-width 980. So >980 likely was 20px */
  .links {
    gap: 20px;
  }
}

/* --- Large Desktop (min-width: 1101px) --- */
@media (min-width: 1101px) {
  .bar {
    gap: 56px;
  }
}

/* Reduced Motion */
@media (prefers-reduced-motion: reduce) {
  .bar {
    transition: none;
  }

  .linksOpen {
    animation: none;
    opacity: 1;
    transform: none;
  }

  .pulse,
  .pulse::after {
    animation: none;
    box-shadow: none;
  }
}

/* RTL Support */
:global(html[dir="rtl"]) .links {
  direction: rtl;
}

:global(html[lang="fa"]) .links .link,
:global(html[lang="fa"]) .localeText,
:global(html[lang="fa"]) .contactLabelMobile {
  letter-spacing: normal;
}

/* --- About Page Variant (Glassmorphism) --- */
.navAboutVariant {
  /* Keep all positioning and spacing the same */
}

.barAboutVariant {
  /* Glassmorphism styling */
  background: rgba(217, 217, 217, 0.26) !important;
  border: 1px solid #E4E4E4 !important;
  backdrop-filter: blur(18.35px);
  -webkit-backdrop-filter: blur(18.35px);
}

/* Avatar border on About page */
.barAboutVariant .avatar img {
  border-color: #8F8F8F;
}

/* Links color on About page */
.barAboutVariant .link {
  color: #FFFFFF !important;
}

.barAboutVariant .link:hover {
  opacity: 0.8;
}

/* Contact button on About page */
.barAboutVariant .contactBtn {
  background: #FFFFFF !important;
  color: #1F67F1 !important;
}

.barAboutVariant .contactBtn:hover {
  background: #FFFFFF !important;
  opacity: 0.95;
}

/* Active link indicator - orange dot */
.barAboutVariant .linkActive::after {
  content: '';
  position: absolute;
  bottom: -10px;
  left: 50%;
  transform: translateX(-50%);
  width: 11px;
  height: 11px;
  background-color: #EA5039;
  border-radius: 50%;
}

/* Menu button icon color on About page */
.barAboutVariant .menuIcon {
  color: #FFFFFF;
}

/* Mobile menu text color */
.barAboutVariant .contactLabelMobile,
.barAboutVariant .contactLabelDesktop {
  color: #1F67F1;
}

/* Remove white background from contact button on mobile About page */
@media (max-width: 720px) {
  .barAboutVariant .contactBtn {
    background: transparent !important;
    color: var(--bg-gray) !important;
  }
  
  .barAboutVariant .contactLabelMobile {
    color: var(--c-white) !important;
  }
}

/* Desktop-specific adjustments */
@media (min-width: 1025px) {
  .barAboutVariant {
    max-width: 1013px;
  }
}